<div align="center">

# ğŸ™ï¸ TTS Web

<p>
  <strong>åŠŸèƒ½å¼ºå¤§ã€æ”¯æŒæ’ä»¶åŒ–çš„æ–‡æœ¬è½¬è¯­éŸ³ Web åº”ç”¨</strong>
</p>

<p>
  <img src="https://img.shields.io/badge/Next.js-16.0.6-black?style=flat-square&logo=next.js" alt="Next.js">
  <img src="https://img.shields.io/badge/React-19.2.0-61dafb?style=flat-square&logo=react" alt="React">
  <img src="https://img.shields.io/badge/TypeScript-5.x-3178c6?style=flat-square&logo=typescript" alt="TypeScript">
  <img src="https://img.shields.io/badge/Prisma-5.x-2d3748?style=flat-square&logo=prisma" alt="Prisma">
  <img src="https://img.shields.io/badge/License-MIT-green?style=flat-square" alt="License">
</p>

</div>

---

## ğŸ“– ç›®å½•

- [âœ¨ åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [ğŸ› ï¸ æŠ€æœ¯æ ˆ](#ï¸-æŠ€æœ¯æ ˆ)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
  - [å¼€å‘ç¯å¢ƒéƒ¨ç½²](#å¼€å‘ç¯å¢ƒéƒ¨ç½²)
  - [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
  - [Docker éƒ¨ç½²](#docker-éƒ¨ç½²)
- [âš™ï¸ ç¯å¢ƒå˜é‡](#ï¸-ç¯å¢ƒå˜é‡)
- [ğŸ“‚ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [ğŸ“˜ ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)
- [â“ å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)
- [ğŸ”Œ API æ–‡æ¡£](#-api-æ–‡æ¡£)
- [ğŸ¤ è´¡çŒ®](#-è´¡çŒ®)
- [ğŸ“„ å¼€æºè®¸å¯](#-å¼€æºè®¸å¯)

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **ğŸ”Œ åŠ¨æ€æ’ä»¶ç³»ç»Ÿ**ï¼šé€šè¿‡ç¼–å†™ JavaScript ä»£ç ï¼Œè½»æ¾é›†æˆå’Œæ‰©å±•æ–°çš„ TTS æœåŠ¡
- **ğŸ›ï¸ å‚æ•°åŒ–è¯­éŸ³åˆæˆ**ï¼šæ”¯æŒè°ƒæ•´è¯­é€Ÿã€éŸ³è°ƒã€éŸ³é‡ç­‰å¤šç§è¯­éŸ³å‚æ•°
- **ğŸ’¾ æ™ºèƒ½éŸ³é¢‘ç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜å·²ç”Ÿæˆçš„éŸ³é¢‘ï¼Œå‡å°‘é‡å¤è¯·æ±‚ï¼Œæå‡å“åº”é€Ÿåº¦
- **ğŸ¨ ç°ä»£åŒ–ç•Œé¢**ï¼šä½¿ç”¨ Ant Design æ„å»ºï¼Œæä¾›æ¸…æ™°ç›´è§‚çš„æ“ä½œä½“éªŒ
- **ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²**ï¼šæä¾› Dockerfile å’Œ docker-composeï¼Œå®ç°ä¸€é”®éƒ¨ç½²
- **ğŸ”§ çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§æ•°æ®åº“ï¼ˆSQLiteã€PostgreSQLã€MySQLï¼‰

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| **å‰ç«¯æ¡†æ¶** | [Next.js 16](https://nextjs.org/) (App Router) + [React 19](https://react.dev/) |
| **å¼€å‘è¯­è¨€** | [TypeScript 5](https://www.typescriptlang.org/) |
| **UI æ¡†æ¶** | [Ant Design 6](https://ant.design/) + [TailwindCSS 4](https://tailwindcss.com/) |
| **åç«¯** | Next.js API Routes |
| **æ•°æ®åº“ ORM** | [Prisma 5](https://www.prisma.io/) |
| **æ•°æ®åº“** | SQLite (é»˜è®¤) / PostgreSQL / MySQL |
| **åŒ…ç®¡ç†å™¨** | [pnpm](https://pnpm.io/) |
| **å®¹å™¨åŒ–** | [Docker](https://www.docker.com/) + Docker Compose |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

é€‚ç”¨äºæœ¬åœ°å¼€å‘å’Œè°ƒè¯•ã€‚

#### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

- **Node.js** â‰¥ 20.0.0 ([ä¸‹è½½](https://nodejs.org/))
- **pnpm** â‰¥ 10.0.0 (æ¨è) æˆ– npm/yarn

å®‰è£… pnpmï¼š

```bash
npm install -g pnpm
```

#### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/foamcold/tts-web.git
cd tts-web
```

#### 3. å®‰è£…ä¾èµ–

```bash
pnpm install
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œä½¿ç”¨é»˜è®¤é…ç½®å¯è·³è¿‡æ­¤æ­¥éª¤ï¼‰ï¼š

```bash
cp .env.example .env
```

#### 5. åˆå§‹åŒ–æ•°æ®åº“

é¦–æ¬¡è¿è¡Œæ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ–æ•°æ®åº“å¹¶ç”Ÿæˆ Prisma Clientï¼š

```bash
npx prisma migrate dev
```

#### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨ã€‚

---

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

é€‚ç”¨äºæœ¬åœ°æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒæˆ–æœåŠ¡å™¨éƒ¨ç½²ã€‚

> **âš ï¸ é‡è¦æç¤º**  
> å¿…é¡»æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼Œå¦åˆ™ä¼šå¯¼è‡´æ„å»ºå¤±è´¥ï¼

#### 1. å…‹éš†é¡¹ç›®å¹¶å®‰è£…ä¾èµ–

```bash
git clone https://github.com/foamcold/tts-web.git
cd tts-web
pnpm install
```

#### 2. åˆå§‹åŒ–æ•°æ®åº“

**åœ¨æ„å»ºä¹‹å‰**å¿…é¡»å…ˆåˆå§‹åŒ–æ•°æ®åº“ä»¥ç”Ÿæˆ Prisma Clientï¼š

```bash
npx prisma migrate deploy
# æˆ–è€…ä½¿ç”¨å¼€å‘æ¨¡å¼è¿ç§»
npx prisma migrate dev
```

#### 3. æ„å»ºåº”ç”¨

```bash
pnpm build
```

#### 4. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨

```bash
pnpm start
```

æˆ–ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆè‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼‰ï¼š

```bash
pnpm start:prod
```

> **ğŸ’¡ æç¤º**  
> `start:prod` è„šæœ¬ä¼šåœ¨å¯åŠ¨å‰è‡ªåŠ¨æ‰§è¡Œ `prisma migrate deploy`ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ [http://localhost:3000](http://localhost:3000) è®¿é—®åº”ç”¨ã€‚

---

### Docker éƒ¨ç½²

æ¨èçš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–¹å¼ï¼Œå¼€ç®±å³ç”¨ã€‚

#### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

1. **ç¡®ä¿å·²å®‰è£… Docker å’Œ Docker Compose**

   - [å®‰è£… Docker](https://docs.docker.com/get-docker/)
   - [å®‰è£… Docker Compose](https://docs.docker.com/compose/install/)

2. **æ„å»ºå¹¶å¯åŠ¨å®¹å™¨**

   åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

   ```bash
   docker-compose up --build -d
   ```

   è¯¥å‘½ä»¤ä¼šï¼š
   - æ„å»º Docker é•œåƒ
   - åœ¨åå°å¯åŠ¨ `tts-web` æœåŠ¡
   - è‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»

3. **è®¿é—®åº”ç”¨**

   æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:3000](http://localhost:3000)

4. **æŸ¥çœ‹æ—¥å¿—**

   ```bash
   docker-compose logs -f
   ```

5. **åœæ­¢æœåŠ¡**

   ```bash
   docker-compose down
   ```

#### ä½¿ç”¨ Dockerfile å•ç‹¬éƒ¨ç½²

å¦‚æœä¸æƒ³ä½¿ç”¨ docker-composeï¼Œå¯ç›´æ¥é€šè¿‡ Dockerfile æ„å»ºå’Œè¿è¡Œã€‚

1. **æ„å»ºé•œåƒ**

   ```bash
   docker build -t tts-web .
   ```

2. **è¿è¡Œå®¹å™¨**

   ```bash
   docker run -d -p 3000:3000 --name tts-web-app tts-web
   ```

3. **è®¿é—®åº”ç”¨**

   æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:3000](http://localhost:3000)

---

## âš™ï¸ ç¯å¢ƒå˜é‡

é¡¹ç›®æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ã€‚å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶æ ¹æ®éœ€è¦ä¿®æ”¹ã€‚

### é…ç½®é¡¹è¯´æ˜

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| `PORT` | åº”ç”¨æœåŠ¡ç«¯å£ | `3000` | å¦ |
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | `file:./dev.db` | å¦ |
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | `development` | å¦ |

### æ•°æ®åº“é…ç½®ç¤ºä¾‹

**SQLiteï¼ˆé»˜è®¤ï¼‰**

```env
DATABASE_URL="file:./dev.db"
```

**PostgreSQL**

```env
DATABASE_URL="postgresql://user:password@localhost:5432/tts_web"
```

**MySQL**

```env
DATABASE_URL="mysql://user:password@localhost:3306/tts_web"
```

> **ğŸ“Œ æ³¨æ„**  
> å¦‚æœæ›´æ”¹æ•°æ®åº“ç±»å‹ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹ `prisma/schema.prisma` ä¸­çš„ `provider` é…ç½®ï¼Œå¹¶é‡æ–°æ‰§è¡Œæ•°æ®åº“è¿ç§»ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ app/                    # Next.js App Router ç›®å½•
â”‚   â”œâ”€â”€ api/                # åç«¯ API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ plugins/        # æ’ä»¶ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ tts/            # TTS æœåŠ¡ API
â”‚   â”‚   â””â”€â”€ settings/       # ç³»ç»Ÿè®¾ç½® API
â”‚   â”œâ”€â”€ plugins/            # æ’ä»¶ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ settings/           # ç³»ç»Ÿè®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ test/               # TTS æµ‹è¯•é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx            # é¦–é¡µ
â”œâ”€â”€ components/             # React ç»„ä»¶
â”‚   â”œâ”€â”€ AudioPlayer.tsx     # éŸ³é¢‘æ’­æ”¾å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ PluginEditor.tsx    # æ’ä»¶ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lib/                    # æ ¸å¿ƒé€»è¾‘ä¸æœåŠ¡
â”‚   â”œâ”€â”€ tts-engine/         # TTS æ’ä»¶å¼•æ“æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ worker-entry.mjs # Worker å…¥å£
â”‚   â”‚   â””â”€â”€ ttsrv-shim.ts   # TTS ç¯å¢ƒæ¨¡æ‹Ÿ
â”‚   â”œâ”€â”€ services/           # åº”ç”¨æœåŠ¡
â”‚   â””â”€â”€ prisma.ts           # Prisma å®¢æˆ·ç«¯å®ä¾‹
â”œâ”€â”€ prisma/                 # Prisma é…ç½®å’Œè¿ç§»
â”‚   â”œâ”€â”€ schema.prisma       # æ•°æ®åº“æ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ migrations/         # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”œâ”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ Dockerfile              # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml      # Docker Compose é…ç½®
â”œâ”€â”€ entrypoint.sh           # Docker å¯åŠ¨è„šæœ¬
â”œâ”€â”€ package.json            # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
â”œâ”€â”€ tsconfig.json           # TypeScript é…ç½®
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

---

## ğŸ“˜ ä½¿ç”¨æŒ‡å—

### æ’ä»¶ç®¡ç†

1. è®¿é—® **/plugins** é¡µé¢
2. ç‚¹å‡»"æ–°å»ºæ’ä»¶"æŒ‰é’®
3. å¡«å†™æ’ä»¶ä¿¡æ¯ï¼ˆåç§°ã€ä½œè€…ã€IDï¼‰
4. ç¼–å†™æ’ä»¶ä»£ç ï¼ˆåŸºäº JavaScriptï¼‰
5. ä¿å­˜å¹¶å¯ç”¨æ’ä»¶

### TTS æµ‹è¯•

1. è®¿é—® **/test** é¡µé¢
2. é€‰æ‹©å·²å¯ç”¨çš„ TTS æ’ä»¶
3. è¾“å…¥è¦åˆæˆçš„æ–‡æœ¬
4. è°ƒæ•´è¯­éŸ³å‚æ•°ï¼ˆè¯­é€Ÿã€éŸ³è°ƒã€éŸ³é‡ç­‰ï¼‰
5. ç‚¹å‡»"åˆæˆ"æŒ‰é’®ç”ŸæˆéŸ³é¢‘
6. ä½¿ç”¨å†…ç½®æ’­æ”¾å™¨æ’­æ”¾æˆ–ä¸‹è½½éŸ³é¢‘

### ç³»ç»Ÿè®¾ç½®

è®¿é—® **/settings** é¡µé¢å¯ä»¥é…ç½®ï¼š

- ç¼“å­˜ç­–ç•¥
- ç³»ç»Ÿå‚æ•°
- å…¶ä»–å…¨å±€é…ç½®

---

## â“ å¸¸è§é—®é¢˜

### 1. æ„å»ºæ—¶æŠ¥é”™ï¼š`Module '@prisma/client' has no exported member 'PrismaClient'`

**åŸå› ï¼š** åœ¨è¿è¡Œ `pnpm build` ä¹‹å‰æ²¡æœ‰åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¯¼è‡´ Prisma Client æœªç”Ÿæˆã€‚

**è§£å†³æ–¹æ¡ˆï¼š** æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ“ä½œï¼š

```bash
# 1. å®‰è£…ä¾èµ–
pnpm install

# 2. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆç”Ÿæˆ Prisma Clientï¼‰
npx prisma migrate deploy

# 3. æ„å»ºåº”ç”¨
pnpm build

# 4. å¯åŠ¨æœåŠ¡
pnpm start
```

### 2. å¼€å‘ç¯å¢ƒæŠ¥é”™ï¼š`require is not defined in ES module scope`

**åŸå› ï¼š** é¡¹ç›®é…ç½®ä¸º ES æ¨¡å—ï¼Œä½†ä»£ç ä¸­ä½¿ç”¨äº† CommonJS çš„ `require` è¯­æ³•ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** å°† `require` æ”¹ä¸º `import`ã€‚ä¾‹å¦‚ï¼š

```typescript
// âŒ é”™è¯¯
const request = require('sync-request');

// âœ… æ­£ç¡®
import request from 'sync-request';
```

### 3. Docker å®¹å™¨å¯åŠ¨å¤±è´¥

**æ’æŸ¥æ­¥éª¤ï¼š**

1. æŸ¥çœ‹æ—¥å¿—ï¼š`docker-compose logs -f`
2. æ£€æŸ¥ç«¯å£å ç”¨ï¼š`netstat -ano | findstr :3000`ï¼ˆWindowsï¼‰æˆ– `lsof -i :3000`ï¼ˆLinux/Macï¼‰
3. ç¡®ä¿ Docker æœ‰è¶³å¤Ÿçš„èµ„æºï¼ˆå†…å­˜ã€CPUï¼‰

### 4. å¦‚ä½•åˆ‡æ¢æ•°æ®åº“ï¼Ÿ

1. ä¿®æ”¹ `.env` ä¸­çš„ `DATABASE_URL`
2. ä¿®æ”¹ `prisma/schema.prisma` ä¸­çš„ `provider`ï¼š

   ```prisma
   datasource db {
     provider = "postgresql"  // æˆ– "mysql"
     url      = env("DATABASE_URL")
   }
   ```

3. é‡æ–°ç”Ÿæˆ Prisma Client å¹¶è¿ç§»ï¼š

   ```bash
   npx prisma generate
   npx prisma migrate dev
   ```

---

## ğŸ”Œ API æ–‡æ¡£

### ç”ŸæˆéŸ³é¢‘ API

TTS Web æä¾› RESTful API æ¥å£ï¼Œæ”¯æŒé€šè¿‡ HTTP è¯·æ±‚ç”Ÿæˆè¯­éŸ³éŸ³é¢‘ã€‚

#### æ¥å£ä¿¡æ¯

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| **URL** | `/api/tts` |
| **æ–¹æ³•** | `GET` / `POST` |
| **å“åº”ç±»å‹** | éŸ³é¢‘äºŒè¿›åˆ¶æ•°æ®ï¼ˆæˆåŠŸæ—¶ï¼‰æˆ– JSONï¼ˆè°ƒè¯•æ¨¡å¼/é”™è¯¯æ—¶ï¼‰ |

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|------|------|--------|
| `text` | string | âœ… æ˜¯ | è¦åˆæˆçš„æ–‡æœ¬å†…å®¹ | - |
| `pluginId` | string | å¦ | ä½¿ç”¨çš„ TTS æ’ä»¶ ID | ç³»ç»Ÿé»˜è®¤æ’ä»¶ |
| `voice` | string | å¦ | å£°éŸ³åç§°/ID | æ’ä»¶é»˜è®¤å£°éŸ³ |
| `locale` | string | å¦ | è¯­è¨€åŒºåŸŸä»£ç ï¼ˆå¦‚ `zh-CN`ï¼‰ | æ’ä»¶é»˜è®¤è¯­è¨€ |
| `speed` | number | å¦ | è¯­é€Ÿï¼ŒèŒƒå›´ 0-100 | 50 |
| `volume` | number | å¦ | éŸ³é‡ï¼ŒèŒƒå›´ 0-100 | 50 |
| `pitch` | number | å¦ | éŸ³è°ƒï¼ŒèŒƒå›´ 0-100 | 50 |
| `debug` | boolean | å¦ | å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œè¿”å› JSON è€ŒééŸ³é¢‘ | false |

> **ğŸ’¡ æç¤º**
> é™¤ä¸Šè¿°å‚æ•°å¤–ï¼ŒAPI è¿˜æ”¯æŒä¼ é€’æ’ä»¶ç‰¹å®šçš„è‡ªå®šä¹‰å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šç›´æ¥ä¼ é€’ç»™å¯¹åº”çš„ TTS æ’ä»¶å¤„ç†ã€‚

#### å“åº”å¤´

| å“åº”å¤´ | è¯´æ˜ |
|--------|------|
| `Content-Type` | éŸ³é¢‘ MIME ç±»å‹ï¼ˆå¦‚ `audio/mpeg`ã€`audio/wav`ï¼‰ |
| `Content-Length` | éŸ³é¢‘æ•°æ®å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `X-TTS-Cache` | ç¼“å­˜çŠ¶æ€ï¼ˆ`hit` è¡¨ç¤ºå‘½ä¸­ç¼“å­˜ï¼Œ`miss` è¡¨ç¤ºæ–°ç”Ÿæˆï¼‰ |

#### è¯·æ±‚ç¤ºä¾‹

##### 1. GET è¯·æ±‚ï¼ˆåŸºç¡€ç”¨æ³•ï¼‰

ä½¿ç”¨ URL æŸ¥è¯¢å‚æ•°ä¼ é€’æ•°æ®ï¼š

```bash
# åŸºç¡€è¯·æ±‚ - ä»…ä¼ é€’æ–‡æœ¬
curl "http://localhost:3000/api/tts?text=ä½ å¥½ï¼Œä¸–ç•Œ" --output hello.mp3

# å®Œæ•´å‚æ•°è¯·æ±‚
curl "http://localhost:3000/api/tts?text=æ¬¢è¿ä½¿ç”¨TTSæœåŠ¡&pluginId=edge-tts&voice=zh-CN-XiaoxiaoNeural&speed=60&volume=80&pitch=50" --output welcome.mp3
```

##### 2. POST è¯·æ±‚ï¼ˆJSON Bodyï¼‰

ä½¿ç”¨ JSON æ ¼å¼ä¼ é€’æ•°æ®ï¼Œé€‚åˆä¼ é€’è¾ƒé•¿æ–‡æœ¬æˆ–å¤æ‚å‚æ•°ï¼š

```bash
# åŸºç¡€ POST è¯·æ±‚
curl -X POST "http://localhost:3000/api/tts" \
  -H "Content-Type: application/json" \
  -d '{"text": "è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ–‡æœ¬"}' \
  --output test.mp3

# å®Œæ•´å‚æ•° POST è¯·æ±‚
curl -X POST "http://localhost:3000/api/tts" \
  -H "Content-Type: application/json" \
  -d '{
    "text": "æ¬¢è¿ä½¿ç”¨ TTS Web æ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡",
    "pluginId": "edge-tts",
    "voice": "zh-CN-YunxiNeural",
    "locale": "zh-CN",
    "speed": 55,
    "volume": 75,
    "pitch": 50
  }' \
  --output output.mp3
```

##### 3. POST è¯·æ±‚ï¼ˆForm Dataï¼‰

ä½¿ç”¨è¡¨å•æ ¼å¼ä¼ é€’æ•°æ®ï¼š

```bash
curl -X POST "http://localhost:3000/api/tts" \
  -d "text=è¡¨å•æäº¤çš„æ–‡æœ¬å†…å®¹" \
  -d "speed=60" \
  -d "volume=80" \
  --output form-output.mp3
```

##### 4. è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•æ¨¡å¼è¿”å› JSON ä¿¡æ¯è€ŒééŸ³é¢‘æ•°æ®ï¼š

```bash
curl "http://localhost:3000/api/tts?text=è°ƒè¯•æµ‹è¯•&debug=true"
```

å“åº”ç¤ºä¾‹ï¼š

```json
{
  "success": true,
  "params": {
    "text": "è°ƒè¯•æµ‹è¯•",
    "pluginId": "edge-tts",
    "voice": "zh-CN-XiaoxiaoNeural",
    "speed": 50,
    "volume": 50,
    "pitch": 50
  },
  "plugin": {
    "id": "edge-tts",
    "name": "Edge TTS"
  }
}
```

#### ç¼–ç¨‹è¯­è¨€ç¤ºä¾‹

##### JavaScript / Node.js

```javascript
// ä½¿ç”¨ fetch API
async function generateSpeech(text, options = {}) {
  const response = await fetch('http://localhost:3000/api/tts', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      text,
      ...options,
    }),
  });

  if (!response.ok) {
    throw new Error(`TTS è¯·æ±‚å¤±è´¥: ${response.status}`);
  }

  // è·å–éŸ³é¢‘ Blob
  const audioBlob = await response.blob();
  
  // æ£€æŸ¥ç¼“å­˜çŠ¶æ€
  const cacheStatus = response.headers.get('X-TTS-Cache');
  console.log(`ç¼“å­˜çŠ¶æ€: ${cacheStatus}`);
  
  return audioBlob;
}

// ä½¿ç”¨ç¤ºä¾‹
const audio = await generateSpeech('ä½ å¥½ï¼Œä¸–ç•Œ', {
  voice: 'zh-CN-XiaoxiaoNeural',
  speed: 60,
});
```

##### Python

```python
import requests

def generate_speech(text, **options):
    """
    è°ƒç”¨ TTS API ç”Ÿæˆè¯­éŸ³
    """
    url = "http://localhost:3000/api/tts"
    payload = {"text": text, **options}
    
    response = requests.post(url, json=payload)
    response.raise_for_status()
    
    # è·å–ç¼“å­˜çŠ¶æ€
    cache_status = response.headers.get("X-TTS-Cache")
    print(f"ç¼“å­˜çŠ¶æ€: {cache_status}")
    
    return response.content

# ä½¿ç”¨ç¤ºä¾‹
audio_data = generate_speech(
    "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ®µæµ‹è¯•è¯­éŸ³",
    voice="zh-CN-YunxiNeural",
    speed=55,
    volume=80
)

# ä¿å­˜éŸ³é¢‘æ–‡ä»¶
with open("output.mp3", "wb") as f:
    f.write(audio_data)
```

##### PHP

```php
<?php

function generateSpeech(string $text, array $options = []): string
{
    $url = "http://localhost:3000/api/tts";
    $data = array_merge(['text' => $text], $options);
    
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    if ($httpCode !== 200) {
        throw new Exception("TTS è¯·æ±‚å¤±è´¥: HTTP $httpCode");
    }
    
    return $response;
}

// ä½¿ç”¨ç¤ºä¾‹
$audio = generateSpeech("ä½ å¥½ï¼Œä¸–ç•Œ", [
    'voice' => 'zh-CN-XiaoxiaoNeural',
    'speed' => 60
]);

file_put_contents("output.mp3", $audio);
```

#### é”™è¯¯å“åº”

å½“è¯·æ±‚å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒAPI è¿”å› JSON æ ¼å¼çš„é”™è¯¯ä¿¡æ¯ï¼š

```json
{
  "error": "Text is required",
  "code": "VALIDATION_ERROR"
}
```

å¸¸è§é”™è¯¯ç ï¼š

| é”™è¯¯ç  | HTTP çŠ¶æ€ç  | è¯´æ˜ |
|--------|-------------|------|
| `VALIDATION_ERROR` | 400 | è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥ |
| `PLUGIN_NOT_FOUND` | 404 | æŒ‡å®šçš„æ’ä»¶ä¸å­˜åœ¨ |
| `TTS_ERROR` | 500 | TTS æœåŠ¡å†…éƒ¨é”™è¯¯ |

---

## ğŸ“„ å¼€æºè®¸å¯

æœ¬é¡¹ç›®åŸºäº [MIT License](LICENSE) å¼€æºã€‚

---

<div align="center">

**[â¬† è¿”å›é¡¶éƒ¨](#-tts-web)**

Made with â¤ï¸ by [foamcold](https://github.com/foamcold)

</div>
